{"version":3,"names":["_options","require","_statement","_scope","Parser","StatementParser","constructor","options","input","pluginsMap","getOptions","initializeScopes","plugins","filename","sourceFilename","startIndex","optionFlags","allowAwaitOutsideFunction","OptionFlags","AllowAwaitOutsideFunction","allowReturnOutsideFunction","AllowReturnOutsideFunction","allowImportExportEverywhere","AllowImportExportEverywhere","allowSuperOutsideMethod","AllowSuperOutsideMethod","allowUndeclaredExports","AllowUndeclaredExports","allowNewTargetOutsideFunction","AllowNewTargetOutsideFunction","ranges","Ranges","tokens","Tokens","createImportExpressions","CreateImportExpressions","createParenthesizedExpressions","CreateParenthesizedExpressions","errorRecovery","ErrorRecovery","attachComment","AttachComment","annexB","AnnexB","getScopeHandler","ScopeHandler","parse","enterInitialScopes","file","startNode","program","nextToken","errors","parseTopLevel","state","comments","length","commentsLen","exports","default"],"sources":["../../src/parser/index.ts"],"sourcesContent":["import type { Options } from \"../options.ts\";\nimport type * as N from \"../types.ts\";\nimport { getOptions, OptionFlags } from \"../options.ts\";\nimport StatementParser from \"./statement.ts\";\nimport ScopeHandler from \"../util/scope.ts\";\n\nexport type PluginsMap = Map<\n  string,\n  {\n    [x: string]: any;\n  }\n>;\n\nexport default class Parser extends StatementParser {\n  // Forward-declaration so typescript plugin can override jsx plugin\n  // todo(flow->ts) - this probably can be removed\n  // abstract jsxParseOpeningElementAfterName(\n  //   node: N.JSXOpeningElement,\n  // ): N.JSXOpeningElement;\n\n  constructor(\n    options: Options | undefined | null,\n    input: string,\n    pluginsMap: PluginsMap,\n  ) {\n    options = getOptions(options);\n    super(options, input);\n\n    this.options = options;\n    this.initializeScopes();\n    this.plugins = pluginsMap;\n    this.filename = options.sourceFilename;\n    this.startIndex = options.startIndex;\n\n    let optionFlags = 0;\n    if (options.allowAwaitOutsideFunction) {\n      optionFlags |= OptionFlags.AllowAwaitOutsideFunction;\n    }\n    if (options.allowReturnOutsideFunction) {\n      optionFlags |= OptionFlags.AllowReturnOutsideFunction;\n    }\n    if (options.allowImportExportEverywhere) {\n      optionFlags |= OptionFlags.AllowImportExportEverywhere;\n    }\n    if (options.allowSuperOutsideMethod) {\n      optionFlags |= OptionFlags.AllowSuperOutsideMethod;\n    }\n    if (options.allowUndeclaredExports) {\n      optionFlags |= OptionFlags.AllowUndeclaredExports;\n    }\n    if (options.allowNewTargetOutsideFunction) {\n      optionFlags |= OptionFlags.AllowNewTargetOutsideFunction;\n    }\n    if (options.ranges) {\n      optionFlags |= OptionFlags.Ranges;\n    }\n    if (options.tokens) {\n      optionFlags |= OptionFlags.Tokens;\n    }\n    if (options.createImportExpressions) {\n      optionFlags |= OptionFlags.CreateImportExpressions;\n    }\n    if (options.createParenthesizedExpressions) {\n      optionFlags |= OptionFlags.CreateParenthesizedExpressions;\n    }\n    if (options.errorRecovery) {\n      optionFlags |= OptionFlags.ErrorRecovery;\n    }\n    if (options.attachComment) {\n      optionFlags |= OptionFlags.AttachComment;\n    }\n    if (options.annexB) {\n      optionFlags |= OptionFlags.AnnexB;\n    }\n\n    this.optionFlags = optionFlags;\n  }\n\n  // This can be overwritten, for example, by the TypeScript plugin.\n  getScopeHandler(): new (...args: any) => ScopeHandler {\n    return ScopeHandler;\n  }\n\n  parse(): N.File {\n    this.enterInitialScopes();\n    const file = this.startNode<N.File>();\n    const program = this.startNode<N.Program>();\n    this.nextToken();\n    file.errors = null;\n    this.parseTopLevel(file, program);\n    file.errors = this.state.errors;\n    file.comments.length = this.state.commentsLen;\n    return file as N.File;\n  }\n}\n"],"mappings":"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","ignoreList":[]}